
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn import tree

from sklearn.metrics import accuracy_score

data = r"D:\Data\AI & ML\Udemy_DT, RF, XGBoost\Classification Tree\Movie_classification.csv"

class AdaAcc:
    def __init__(self):
        self.y_train = None
        self.y_test = None

    def Predict(self, dframe):
        clstree = tree.DecisionTreeClassifier(max_depth=3)

        df = pd.read_csv(dframe)

        df.fillna({'Time_taken': df['Time_taken'].mean()}, inplace=True)
        df = pd.get_dummies(df, columns=['3D_available', 'Genre'], drop_first=True)

        y = df['Start_Tech_Oscar']
        X = df.drop(['Start_Tech_Oscar'], axis=1)

        X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)

        self.X_train = X_train
        self.y_train = y_train
        self.X_test = X_test
        self.y_test = y_test

        clstree.fit(X_train, y_train)

        y_test_pred = clstree.predict(X_test)
        y_train_pred = clstree.predict(X_train)

        self.y_train = y_train
        self.y_train_pred = y_train_pred

        return (
            ("Train", accuracy_score(y_train, y_train_pred)),
            ("test", accuracy_score(y_test, y_test_pred))
        )

    def PredictBoost(self):
        from sklearn.ensemble import AdaBoostClassifier
        ada_boost = AdaBoostClassifier(learning_rate=0.02, n_estimators=5000)

        ada_boost.fit(self.X_train, self.y_train)

        y_test_pred = ada_boost.predict(self.X_test)
        y_train_pred = ada_boost.predict(self.X_train)

        return (
            ("test", accuracy_score(self.y_test, y_test_pred)),
            ("train", accuracy_score(self.y_train, y_train_pred))
        )


a = AdaAcc()
a.Predict(data)
a.PredictBoost()

